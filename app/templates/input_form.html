<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Input Aset Baru</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- PWA -->
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#1976d2">
    <link rel="icon" href="/static/icon-192.png" sizes="192x192" type="image/png">

    <!-- Style -->
    <link rel="stylesheet" href="/static/style.css">

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 1rem;
            max-width: 720px;
            margin: auto;
        }

        h1 {
            text-align: center;
            color: #1976d2;
        }

        form {
            background-color: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        label {
            margin-top: 1rem;
            font-weight: bold;
            display: block;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px;
            margin-top: 4px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
        }

        button {
            margin-top: 1.5rem;
            background-color: #1976d2;
            color: white;
            padding: 10px;
            border: none;
            width: 100%;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
        }

        button:hover {
            background-color: #125ea2;
        }

        .back-link {
            display: block;
            margin: 1rem 0;
            text-align: center;
            text-decoration: none;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <h1>â• Input Aset Baru</h1>

    <a href="/" class="back-link">ğŸ”™ Kembali ke Beranda</a>

    <form method="post">
        <label>ğŸ“¦ Nama Aset</label>
        <input type="text" name="item_name" required>

        <label>ğŸ“ Kategori</label>
        <input list="category_list" name="category" required>
        <datalist id="category_list">
            {% for cat in refs.categories %}
                <option value="{{ cat }}">
            {% endfor %}
        </datalist>

        <label>ğŸ§© Tipe</label>
        <input list="type_list" name="type" required>
        <datalist id="type_list">
            {% for t in refs.types %}
                <option value="{{ t.Type }}">{{ t.Type }} ({{ t.Category }})
            {% endfor %}
        </datalist>

        <label>ğŸ­ Merk / Manufacture</label>
        <input type="text" name="manufacture">

        <label>ğŸ“ Model</label>
        <input type="text" name="model">

        <label>ğŸ”¢ Nomor Seri</label>
        <input type="text" name="serial_number">

        <label>ğŸ¢ Perusahaan</label>
        <input list="company_list" name="company" required>
        <datalist id="company_list">
            {% for c in refs.companies %}
                <option value="{{ c }}">
            {% endfor %}
        </datalist>

        <label>ğŸ·ï¸ Kode Perusahaan</label>
        <input type="text" name="code_company" maxlength="3" required>

        <label>ğŸ­ Unit Bisnis</label>
        <input type="text" name="bisnis_unit">

        <label>ğŸ“ Lokasi</label>
        <select name="location" id="location" onchange="updateRooms()" required>
            <option value="">-- Pilih Lokasi --</option>
            {% for loc in refs.locations %}
                <option value="{{ loc }}">{{ loc }}</option>
            {% endfor %}
        </select>

        <label>ğŸ¢ Ruangan</label>
        <select name="room_location" id="room_location" required>
            <option value="">-- Pilih Ruangan --</option>
        </select>

        <label>ğŸ“ Catatan</label>
        <textarea name="notes" rows="2"></textarea>

        <label>âš™ï¸ Kondisi</label>
        <input type="text" name="condition">

        <label>ğŸ—“ï¸ Tanggal Pembelian</label>
        <input type="date" name="purchase_date" required>

        <label>ğŸ’° Harga Pembelian</label>
        <input type="number" name="purchase_cost" required>

        <label>ğŸ“œ Garansi</label>
        <select name="warranty">
            <option value="No">No</option>
            <option value="Yes">Yes</option>
        </select>

        <label>ğŸšš Supplier</label>
        <input type="text" name="supplier">

        <label>ğŸ“– Jurnal</label>
        <input type="text" name="journal">

        <label>ğŸ‘¤ Penanggung Jawab</label>
        <input list="owner_list" name="owner" required>
        <datalist id="owner_list">
            {% for o in refs.owners %}
                <option value="{{ o }}">
            {% endfor %}
        </datalist>

        <button type="submit">âœ… Simpan Aset</button>
    </form>

    <!-- JS: Filter Room by Location -->
    <script>
        const roomMap = {{ location_room_map | tojson | safe }};

        function updateRooms() {
            const loc = document.getElementById("location").value;
            const roomSelect = document.getElementById("room_location");

            roomSelect.innerHTML = '<option value="">-- Pilih Ruangan --</option>';
            if (roomMap[loc]) {
                roomMap[loc].forEach(room => {
                    const option = document.createElement("option");
                    option.value = room;
                    option.textContent = room;
                    roomSelect.appendChild(option);
                });
            }
        }
    </script>
</body>
</html>
